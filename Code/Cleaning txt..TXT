let
    Source = Csv.Document(File.Contents("C:\Users\Alex Richt\Desktop\R Codes\Transfermarkt Scrap\Scrap\InDepthEuropeansRosters_18_19.csv"),[Delimiter=",", Columns=27, Encoding=1252, QuoteStyle=QuoteStyle.Csv]),
    #"Promoted Headers" = Table.PromoteHeaders(Source, [PromoteAllScalars=true]),
    #"Changed Type" = Table.TransformColumnTypes(#"Promoted Headers",{{"", Int64.Type}, {"FullName", type text}, {"PlayerName", type text}, {"Affiliation", type text}, {"League", type text}, {"Jersey", type text}, {"birthDate", type text}, {"birthPlace", type text}, {"Age", type text}, {"height", type text}, {"Citizenship", type text}, {"position2", type text}, {"Foot", type text}, {"Agent", type text}, {"JoinedClub", type text}, {"LastExtension", type text}, {"ContractExpiration", type text}, {"PlayerSponsor", type text}, {"YouthClubs", type text}, {"nationality", type text}, {"position1", type text}, {"EPLGamesPlayed", type text}, {"PlayerMarketValue", type text}, {"AccumulatedTransfersSum", type text}, {"HighestMarketValue", type text}, {"NationalTeamCaps", type text}, {"MostRecentInjury", type text}}),
    #"Cleaned Text" = Table.TransformColumns(#"Changed Type",{{"League", Text.Clean, type text}}),
    #"Renamed Columns" = Table.RenameColumns(#"Cleaned Text",{{"", "Scrapped Order"}}),
    #"Cleaned Text1" = Table.TransformColumns(#"Renamed Columns",{{"birthDate", Text.Clean, type text}}),
    #"Replaced Value" = Table.ReplaceValue(#"Cleaned Text1","(",", ",Replacer.ReplaceText,{"birthDate"}),
    #"Replaced Value1" = Table.ReplaceValue(#"Replaced Value",")","",Replacer.ReplaceText,{"birthDate"}),
    #"Split Column by Delimiter" = Table.SplitColumn(#"Replaced Value1", "birthDate", Splitter.SplitTextByEachDelimiter({","}, QuoteStyle.Csv, true), {"birthDate.1", "birthDate.2"}),
    #"Changed Type1" = Table.TransformColumnTypes(#"Split Column by Delimiter",{{"birthDate.1", type date}, {"birthDate.2", Int64.Type}}),
    #"Renamed Columns1" = Table.RenameColumns(#"Changed Type1",{{"birthDate.1", "Birth Date"}}),
    #"Trimmed Text" = Table.TransformColumns(#"Renamed Columns1",{{"Citizenship", Text.Trim, type text}, {"position2", Text.Trim, type text}, {"Foot", Text.Trim, type text}, {"Agent", Text.Trim, type text}, {"JoinedClub", Text.Trim, type text}}),
    #"Trimmed Text1" = Table.TransformColumns(#"Trimmed Text",{{"position1", Text.Trim, type text}, {"nationality", Text.Trim, type text}, {"YouthClubs", Text.Trim, type text}, {"PlayerSponsor", Text.Trim, type text}, {"ContractExpiration", Text.Trim, type text}, {"LastExtension", Text.Trim, type text}, {"JoinedClub", Text.Trim, type text}, {"Agent", Text.Trim, type text}, {"Foot", Text.Trim, type text}, {"position2", Text.Trim, type text}, {"Citizenship", Text.Trim, type text}, {"EPLGamesPlayed", Text.Trim, type text}, {"PlayerMarketValue", Text.Trim, type text}, {"AccumulatedTransfersSum", Text.Trim, type text}, {"HighestMarketValue", Text.Trim, type text}, {"NationalTeamCaps", Text.Trim, type text}, {"MostRecentInjury", Text.Trim, type text}}),
    #"Cleaned Text2" = Table.TransformColumns(#"Trimmed Text1",{{"position1", Text.Clean, type text}, {"nationality", Text.Clean, type text}, {"YouthClubs", Text.Clean, type text}, {"PlayerSponsor", Text.Clean, type text}, {"ContractExpiration", Text.Clean, type text}, {"LastExtension", Text.Clean, type text}, {"JoinedClub", Text.Clean, type text}, {"Agent", Text.Clean, type text}, {"Foot", Text.Clean, type text}, {"position2", Text.Clean, type text}, {"Citizenship", Text.Clean, type text}, {"EPLGamesPlayed", Text.Clean, type text}, {"PlayerMarketValue", Text.Clean, type text}, {"AccumulatedTransfersSum", Text.Clean, type text}, {"HighestMarketValue", Text.Clean, type text}, {"NationalTeamCaps", Text.Clean, type text}, {"MostRecentInjury", Text.Clean, type text}}),
    #"Removed Columns" = Table.RemoveColumns(#"Cleaned Text2",{"Age"}),
    #"Renamed Columns2" = Table.RenameColumns(#"Removed Columns",{{"birthDate.2", "Age"}}),
    #"Replaced Value2" = Table.ReplaceValue(#"Renamed Columns2","Return unknown",": Return unknown",Replacer.ReplaceText,{"MostRecentInjury"}),
    #"Replaced Value3" = Table.ReplaceValue(#"Replaced Value2","Return expected",": Return expected",Replacer.ReplaceText,{"MostRecentInjury"}),
    #"Split Column by Delimiter1" = Table.SplitColumn(#"Replaced Value3", "PlayerMarketValue", Splitter.SplitTextByDelimiter("€", QuoteStyle.Csv), {"PlayerMarketValue.1", "PlayerMarketValue.2"}),
    #"Changed Type2" = Table.TransformColumnTypes(#"Split Column by Delimiter1",{{"PlayerMarketValue.1", type text}, {"PlayerMarketValue.2", type text}}),
    #"Renamed Columns3" = Table.RenameColumns(#"Changed Type2",{{"PlayerMarketValue.1", "Market Value"}, {"PlayerMarketValue.2", "Last Updated Date"}}),
    #"Split Column by Delimiter2" = Table.SplitColumn(#"Renamed Columns3", "YouthClubs", Splitter.SplitTextByDelimiter(",", QuoteStyle.Csv), {"YouthClubs.1", "YouthClubs.2", "YouthClubs.3", "YouthClubs.4", "YouthClubs.5", "YouthClubs.6", "YouthClubs.7"}),
    #"Changed Type3" = Table.TransformColumnTypes(#"Split Column by Delimiter2",{{"YouthClubs.1", type text}, {"YouthClubs.2", type text}, {"YouthClubs.3", type text}, {"YouthClubs.4", type text}, {"YouthClubs.5", type text}, {"YouthClubs.6", type text}, {"YouthClubs.7", type text}}),
    #"Renamed Columns4" = Table.RenameColumns(#"Changed Type3",{{"YouthClubs.1", "Youth Club 1"}, {"YouthClubs.2", "Youth Club 2"}, {"YouthClubs.3", "Youth Club 3"}, {"YouthClubs.4", "Youth Club 4"}, {"YouthClubs.5", "Youth Club 5"}, {"YouthClubs.6", "Youth Club 6"}, {"YouthClubs.7", "Youth Club 7"}}),
    #"Split Column by Delimiter3" = Table.SplitColumn(#"Renamed Columns4", "Citizenship", Splitter.SplitTextByDelimiter("#(00A0)", QuoteStyle.Csv), {"Citizenship.1", "Citizenship.2", "Citizenship.3"}),
    #"Changed Type4" = Table.TransformColumnTypes(#"Split Column by Delimiter3",{{"Citizenship.1", type text}, {"Citizenship.2", type text}, {"Citizenship.3", type text}}),
    #"Removed Columns1" = Table.RemoveColumns(#"Changed Type4",{"Citizenship.2"}),
    #"Renamed Columns5" = Table.RenameColumns(#"Removed Columns1",{{"Citizenship.1", "Citizenship 1"}, {"Citizenship.3", "Citizenship 2"}}),
    #"Split Column by Delimiter4" = Table.SplitColumn(#"Renamed Columns5", "FullName", Splitter.SplitTextByDelimiter("<", QuoteStyle.Csv), {"FullName.1", "FullName.2", "FullName.3", "FullName.4", "FullName.5", "FullName.6", "FullName.7", "FullName.8", "FullName.9", "FullName.10", "FullName.11", "FullName.12", "FullName.13", "FullName.14", "FullName.15", "FullName.16", "FullName.17", "FullName.18", "FullName.19", "FullName.20", "FullName.21", "FullName.22", "FullName.23", "FullName.24", "FullName.25", "FullName.26", "FullName.27", "FullName.28", "FullName.29", "FullName.30", "FullName.31"}),
    #"Changed Type5" = Table.TransformColumnTypes(#"Split Column by Delimiter4",{{"FullName.1", type text}, {"FullName.2", type text}, {"FullName.3", type text}, {"FullName.4", type text}, {"FullName.5", type text}, {"FullName.6", type text}, {"FullName.7", type text}, {"FullName.8", type text}, {"FullName.9", type text}, {"FullName.10", type text}, {"FullName.11", type text}, {"FullName.12", type text}, {"FullName.13", type text}, {"FullName.14", type text}, {"FullName.15", type text}, {"FullName.16", type text}, {"FullName.17", type text}, {"FullName.18", type text}, {"FullName.19", type text}, {"FullName.20", type text}, {"FullName.21", type text}, {"FullName.22", type text}, {"FullName.23", type text}, {"FullName.24", type text}, {"FullName.25", type text}, {"FullName.26", type text}, {"FullName.27", type text}, {"FullName.28", type text}, {"FullName.29", type text}, {"FullName.30", type text}, {"FullName.31", type text}}),
    #"Removed Columns2" = Table.RemoveColumns(#"Changed Type5",{"FullName.2", "FullName.3", "FullName.4", "FullName.5", "FullName.6", "FullName.7", "FullName.8", "FullName.9", "FullName.10", "FullName.11", "FullName.12", "FullName.13", "FullName.14", "FullName.15", "FullName.16", "FullName.17", "FullName.18", "FullName.19", "FullName.20", "FullName.21", "FullName.22", "FullName.23", "FullName.24", "FullName.25", "FullName.26", "FullName.27", "FullName.28", "FullName.29", "FullName.30", "FullName.31", "Scrapped Order"}),
    #"Cleaned Text" = Table.TransformColumns(#"Changed Type",{{"Agent", Text.Clean, type text}}),
    #"Replaced Value" = Table.ReplaceValue(#"Cleaned Text","_x000D_","",Replacer.ReplaceText,{"Agent"}),
    #"Replaced Value1" = Table.ReplaceValue(#"Replaced Value","Agent:","",Replacer.ReplaceText,{"Agent"}),
    #"Replaced Value2" = Table.ReplaceValue(#"Replaced Value1","Position:                            ","",Replacer.ReplaceText,{"position1"}),
    #"Reordered Columns" = Table.ReorderColumns(#"Replaced Value2",{"FullName", "PlayerName", "Affiliation", "League", "Jersey", "Birth Date", "Age", "birthPlace", "height", "Citizenship 1", "Citizenship 2", "position1", "position2", "Foot", "Agent", "JoinedClub", "LastExtension", "ContractExpiration", "PlayerSponsor", "Youth Club 1", "Youth Club 2", "Youth Club 3", "Youth Club 4", "Youth Club 5", "Youth Club 6", "Youth Club 7", "nationality", "EPLGamesPlayed", "Market Value", "Last Updated Date", "AccumulatedTransfersSum", "HighestMarketValue", "NationalTeamCaps", "MostRecentInjury"}),
    #"Split Column by Delimiter" = Table.SplitColumn(#"Reordered Columns", "position2", Splitter.SplitTextByDelimiter("-", QuoteStyle.Csv), {"position2.1", "position2.2", "position2.3"}),
    #"Changed Type1" = Table.TransformColumnTypes(#"Split Column by Delimiter",{{"position2.1", type text}, {"position2.2", type text}, {"position2.3", type text}}),
    #"Removed Columns" = Table.RemoveColumns(#"Changed Type1",{"position2.2", "position2.3"}),
    #"Renamed Columns" = Table.RenameColumns(#"Removed Columns",{{"position2.1", "Position"}}),
    #"Reordered Columns1" = Table.ReorderColumns(#"Renamed Columns",{"FullName", "PlayerName", "Affiliation", "League", "Jersey", "Birth Date", "Age", "birthPlace", "height", "Citizenship 1", "Citizenship 2", "Position", "position1", "Foot", "Agent", "JoinedClub", "LastExtension", "ContractExpiration", "PlayerSponsor", "Youth Club 1", "Youth Club 2", "Youth Club 3", "Youth Club 4", "Youth Club 5", "Youth Club 6", "Youth Club 7", "nationality", "EPLGamesPlayed", "Market Value", "Last Updated Date", "AccumulatedTransfersSum", "HighestMarketValue", "NationalTeamCaps", "MostRecentInjury"}),
    #"Renamed Columns1" = Table.RenameColumns(#"Reordered Columns1",{{"position1", "Position 2"}})
in
    #"Renamed Columns1"